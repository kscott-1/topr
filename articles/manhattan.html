<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="topr">
<title>Intro into manhattan • topr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intro into manhattan">
<meta property="og:description" content="topr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">topr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/topr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/manhattan.html">Intro into manhattan</a>
    <a class="dropdown-item" href="../articles/regionplot.html">Intro into regionplot</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/totajuliusd/topr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Intro into manhattan</h1>
                        <h4 data-toc-skip class="author">Thorhildur
Juliusdottir</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/totajuliusd/topr/blob/HEAD/vignettes/manhattan.rmd" class="external-link"><code>vignettes/manhattan.rmd</code></a></small>
      <div class="d-none name"><code>manhattan.rmd</code></div>
    </div>

    
    
<p>% %</p>
<p>This needs updating!</p>
<hr>
<div class="section level2">
<h2 id="manhattan">manhattan<a class="anchor" aria-label="anchor" href="#manhattan"></a>
</h2>
<p>Displays GWAS results over the entire genome.</p>
<p>Get an overview of the in-built Crohn’s GWAS results
(<code>CD_UKBB</code>):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan.jpg" width="100%"></p>
<p>Annotate the lead/index variants (with p-values below 5e-9) with
their nearest gene and add a title:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, </span>
<span>          annotate <span class="op">=</span> <span class="fl">5e-09</span>,  </span>
<span>          title <span class="op">=</span> <span class="st">"Crohn's disease"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_annotate.jpg" width="100%"></p>
<p>Display genes of interest at the bottom of the Manhattan plot to get
a visual representation of their position relative to association
peaks:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IL23R"</span>,<span class="st">"NOTCH4"</span>,<span class="st">"NOD2"</span>,<span class="st">"JAK2"</span>,<span class="st">"TTC33"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, </span>
<span>          annotate <span class="op">=</span> <span class="fl">5e-09</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Crohn's disease"</span>, </span>
<span>          highlight_genes <span class="op">=</span> <span class="va">genes</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_genes.jpg" width="100%"></p>
<p>View one chromosome only:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, </span>
<span>          annotate <span class="op">=</span> <span class="fl">5e-09</span>, </span>
<span>          chr <span class="op">=</span> <span class="st">"chr1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_chr1.jpg" width="100%"></p>
<p>Create a Manhattan of multiple GWAS results (represented as a list)
on the same plot</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UC_UKBB</span>, <span class="va">CD_UKBB</span><span class="op">)</span>, </span>
<span>          legend_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UC UKBB"</span>, <span class="st">"CD UKBB"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_multi.jpg" width="100%"></p>
<p>Show three GWAS results on the same plot, using different annotation
thresholds for each dataset. Also, add genes of interest to the plot Use
the ntop argument to control how many GWAS results are displayed at the
top and bottom of the plot:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span>, <span class="va">UC_UKBB</span><span class="op">)</span>, </span>
<span>          legend_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD UKBB"</span>, <span class="st">"CD FinnGen"</span>,<span class="st">"UC UKBB"</span><span class="op">)</span>, </span>
<span>          annotate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-9</span>,<span class="fl">5e-12</span>,<span class="fl">1e-15</span><span class="op">)</span>,</span>
<span>          region_size <span class="op">=</span> <span class="st">"3Mb"</span>, </span>
<span>          ntop <span class="op">=</span> <span class="fl">2</span>, </span>
<span>          highlight_genes <span class="op">=</span> <span class="va">genes</span>, </span>
<span>          highlight_genes_ypos <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> , </span>
<span>          title <span class="op">=</span> <span class="st">"Inflammatory Bowel Disease"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_multi_ntop.jpg" width="100%"></p>
<p>Make the plot prettier by giving more space to the labels by
extending the yaxis (using <code>ymax</code> and <code>ymin</code>) and
by changing the position and angle of the labels (using
<code>angle</code> and the <code>nudge_y</code> arguments).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span>, <span class="va">UC_UKBB</span><span class="op">)</span>, </span>
<span>          legend_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD UKBB"</span>, <span class="st">"CD FinnGen"</span>,<span class="st">"UC UKBB"</span><span class="op">)</span>, </span>
<span>          annotate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-9</span>,<span class="fl">5e-12</span>,<span class="fl">1e-15</span><span class="op">)</span>,</span>
<span>          region_size <span class="op">=</span> <span class="st">"3Mb"</span>,</span>
<span>          ntop <span class="op">=</span> <span class="fl">2</span>, </span>
<span>          highlight_genes <span class="op">=</span> <span class="va">genes</span>, </span>
<span>          highlight_genes_ypos <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Inflammatory Bowel Disease"</span>, </span>
<span>          ymax <span class="op">=</span> <span class="fl">65</span>, </span>
<span>          ymin <span class="op">=</span> <span class="op">-</span><span class="fl">55</span>, </span>
<span>          nudge_y <span class="op">=</span> <span class="fl">12</span>, </span>
<span>          angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_multi_ntop_tidy.jpg" width="100%"></p>
<p>The same plot as above with gray shades/rectangles distinguishing
between chromosomes intead (using <code>theme_gray=T</code>)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span>, <span class="va">UC_UKBB</span><span class="op">)</span>, </span>
<span>          legend_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD UKBB"</span>, <span class="st">"CD FinnGen"</span>,<span class="st">"UC UKBB"</span><span class="op">)</span>, </span>
<span>          annotate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-9</span>,<span class="fl">5e-12</span>,<span class="fl">1e-15</span><span class="op">)</span>,</span>
<span>          region_size <span class="op">=</span> <span class="st">"3Mb"</span>,</span>
<span>          ntop <span class="op">=</span> <span class="fl">2</span>, </span>
<span>          highlight_genes <span class="op">=</span> <span class="va">genes</span>, </span>
<span>          highlight_genes_ypos <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span> , </span>
<span>          title <span class="op">=</span> <span class="st">"Inflammatory Bowel Disease"</span>, </span>
<span>          ymax <span class="op">=</span> <span class="fl">65</span>, </span>
<span>          ymin <span class="op">=</span> <span class="op">-</span><span class="fl">55</span>, </span>
<span>          nudge_y <span class="op">=</span> <span class="fl">12</span>, </span>
<span>          angle <span class="op">=</span> <span class="fl">90</span>, </span>
<span>          theme_grey <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_multi_ntop_tidy_grey.jpg" width="100%"></p>
<p>Use <code>annotate_with_vline</code> to highlight the association
peaks in the <code>CD_UKBB</code> dataset. Use different
<code>alpha</code>, <code>size</code> and <code>shape</code> for the
three datasets.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span>, <span class="va">UC_UKBB</span><span class="op">)</span>, </span>
<span>          legend_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD UKBB"</span>, <span class="st">"CD FinnGen"</span>,<span class="st">"UC UKBB"</span><span class="op">)</span>, </span>
<span>          annotate_with_vline  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-9</span>,<span class="fl">5e-100</span>,<span class="fl">1e-100</span><span class="op">)</span>,</span>
<span>          region_size<span class="op">=</span><span class="st">"3Mb"</span>, </span>
<span>          ntop<span class="op">=</span><span class="fl">1</span>, </span>
<span>          highlight_genes <span class="op">=</span> <span class="va">genes</span>, </span>
<span>          highlight_genes_ypos <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Inflammatory Bowel Disease"</span>, </span>
<span>          nudge_y <span class="op">=</span> <span class="fl">6</span>,</span>
<span>          angle <span class="op">=</span> <span class="fl">90</span>, </span>
<span>          alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>          size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">0.9</span><span class="op">)</span>, </span>
<span>          shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>,<span class="fl">6</span>,<span class="fl">19</span><span class="op">)</span>, </span>
<span>          ymax<span class="op">=</span><span class="fl">33</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/manhattan_multi_ntop_tidy_vline.jpg" width="100%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thorhildur Juliusdottir, Andri Stefansson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
