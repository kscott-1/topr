<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>More manhattan examples â€¢ topr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="More manhattan examples">
<meta name="description" content="The topr package is a set of functions used to visualize, explore and annotate genetic association results.
">
<meta property="og:description" content="The topr package is a set of functions used to visualize, explore and annotate genetic association results.
">
<meta property="og:image" content="https://kscott-1.github.io/topr/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">topr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/topr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/locuszoom.html">Locuszoom plot examples</a></li>
    <li><a class="dropdown-item" href="../articles/manhattanExtra.html">Extending manhattan plots with manhattanExtra</a></li>
    <li><a class="dropdown-item" href="../articles/moreManhattan.html">More manhattan examples</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/totajuliusd/topr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>More manhattan examples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/totajuliusd/topr/blob/doc_testing/vignettes/articles/moreManhattan.Rmd" class="external-link"><code>vignettes/articles/moreManhattan.Rmd</code></a></small>
      <div class="d-none name"><code>moreManhattan.Rmd</code></div>
    </div>

    
    
<p>In addition to a genome-wide Manhattan plot, we can also display a
single chromosome.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, annotate<span class="op">=</span><span class="fl">5e-8</span>, chr<span class="op">=</span><span class="st">"chr1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="moreManhattan_files/figure-html/manh-chr-1.png" width="1152"></p>
<p>Display genes of interest at the bottom of the Manhattan plot to get
a visual representation of their position relative to association
peaks.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IL23R"</span>,<span class="st">"NOTCH4"</span>,<span class="st">"NOD2"</span>,<span class="st">"JAK2"</span>,<span class="st">"TTC33"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, annotate<span class="op">=</span><span class="fl">5e-8</span>, highlight_genes<span class="op">=</span><span class="va">genes</span><span class="op">)</span></span></code></pre></div>
<p><img src="moreManhattan_files/figure-html/gene-highlight-1.png" width="1152"></p>
<p>We can display multiple traits or multiple datasets on the same
Manhattan plot. In the introduction, we saw how to overlap the results.
We can also display the results vertically stacked. We use the
<code>ntop</code> parameter to specify the number of datasets to display
on the top half of the plot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IL23R"</span>,<span class="st">"NOTCH4"</span>,<span class="st">"NOD2"</span>,<span class="st">"JAK2"</span>,<span class="st">"TTC33"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span><span class="op">)</span>,</span>
<span>  legend_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UKBB"</span>, <span class="st">"FinnGen"</span><span class="op">)</span>,</span>
<span>  annotate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-8</span>,<span class="fl">5e-8</span><span class="op">)</span>,</span>
<span>  ntop<span class="op">=</span><span class="fl">1</span>,</span>
<span>  highlight_genes<span class="op">=</span><span class="va">genes</span>,</span>
<span>  highlight_genes_ypos<span class="op">=</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="moreManhattan_files/figure-html/stacked-manh-1.png" width="1152"></p>
<p>Make the plot prettier by giving more space to the labels by
extending the yaxis (using ymax and ymin) and by changing the position
and angle of the labels (using angle and the nudge_y arguments).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IL23R"</span>,<span class="st">"NOTCH4"</span>,<span class="st">"NOD2"</span>,<span class="st">"JAK2"</span>,<span class="st">"TTC33"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span><span class="op">)</span>,</span>
<span>  legend_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UKBB"</span>, <span class="st">"FinnGen"</span><span class="op">)</span>,</span>
<span>  annotate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-8</span>,<span class="fl">5e-8</span><span class="op">)</span>,</span>
<span>  ntop<span class="op">=</span><span class="fl">1</span>,</span>
<span>  highlight_genes<span class="op">=</span><span class="va">genes</span>,</span>
<span>  highlight_genes_ypos<span class="op">=</span><span class="op">-</span><span class="fl">1.5</span>,</span>
<span>  ymin<span class="op">=</span><span class="op">-</span><span class="fl">70</span>,</span>
<span>  ymax<span class="op">=</span><span class="fl">50</span>,</span>
<span>  nudge_y<span class="op">=</span><span class="fl">12</span>,</span>
<span>  angle<span class="op">=</span><span class="fl">90</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="moreManhattan_files/figure-html/prettier-stacked-manh-1.png" width="1152"></p>
<p>The same plot as above with gray shades/rectangles distinguishing
between chromosomes instead (using <code>theme_grey=T</code>)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IL23R"</span>,<span class="st">"NOTCH4"</span>,<span class="st">"NOD2"</span>,<span class="st">"JAK2"</span>,<span class="st">"TTC33"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span><span class="op">)</span>,</span>
<span>    legend_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UKBB"</span>, <span class="st">"FinnGen"</span><span class="op">)</span>,</span>
<span>    annotate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-8</span>,<span class="fl">5e-8</span><span class="op">)</span>,</span>
<span>    ntop<span class="op">=</span><span class="fl">1</span>,</span>
<span>    highlight_genes<span class="op">=</span><span class="va">genes</span>,</span>
<span>    highlight_genes_ypos<span class="op">=</span><span class="op">-</span><span class="fl">1.5</span>,</span>
<span>    ymin<span class="op">=</span><span class="op">-</span><span class="fl">70</span>,</span>
<span>    ymax<span class="op">=</span><span class="fl">50</span>,</span>
<span>    nudge_y<span class="op">=</span><span class="fl">12</span>,</span>
<span>    angle<span class="op">=</span><span class="fl">90</span>,</span>
<span>    theme_grey<span class="op">=</span><span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="moreManhattan_files/figure-html/prettier-stacked-manh-gray-1.png" width="1152"></p>
<p>Use <code>annotate_with_vline</code> to highlight association peaks.
Use different <code>alpha</code>, <code>size</code> and
<code>shape</code> for the two datasets to try to differentiate a little
better.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manhattan.html">manhattan</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, <span class="va">CD_FINNGEN</span><span class="op">)</span>,</span>
<span>    legend_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UKBB"</span>, <span class="st">"FinnGen"</span><span class="op">)</span>,</span>
<span>    annotate_with_vline<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e-8</span>,<span class="fl">5e-8</span><span class="op">)</span>,</span>
<span>    alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.25</span><span class="op">)</span>,</span>
<span>    shape<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">19</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="moreManhattan_files/figure-html/annotate-vline-1.png" width="1152"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thorhildur Juliusdottir, Andri Stefansson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
